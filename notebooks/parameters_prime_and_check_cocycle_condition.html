<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Choosing the parameters prime and check_cocycle_condition &mdash; DREiMac  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Circular coordinates on COIL-20 data set" href="coil20.html" />
    <link rel="prev" title="Choosing the parameter standard_range" href="parameter_standard_range.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DREiMac
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Choosing parameters</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="parameters_n_landmarks_and_cocycle_idx.html">Choosing the parameters n_landmarks and cocycle_idx</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_perc.html">Choosing the parameter perc</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_standard_range.html">Choosing the parameter standard_range</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Choosing the parameters prime and check_cocycle_condition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#The-prime-parameter">The prime parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-check_cocycle_condition-parameter">The check_cocycle_condition parameter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Heuristic-for-lifting-cohomology-classes-and-algorithm-for-fixing-the-lack-cocycle-condition">Heuristic for lifting cohomology classes and algorithm for fixing the lack cocycle condition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Circular coordinates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coil20.html">Circular coordinates on COIL-20 data set</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Toroidal coordinates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bullseye.html">Toroidal coordinates on bullseye</a></li>
<li class="toctree-l1"><a class="reference internal" href="genusTwoSurface.html">Toroidal coordinates on surface of genus two</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Real projective coordinates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ImagePatches.html">Real projective coordinates on data set of image patches</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Complex projective coordinates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="twoSphere.html">Complex projective coordinates on a 2-sphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="movingDot.html">Complex projective coordinates on data set of image patches</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lens coordinates</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="circleLensCoordinates.html">Lens coordinates on a circle</a></li>
<li class="toctree-l1"><a class="reference internal" href="MooreSpace.html">Lens coordinates on Moore space</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DREiMac</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Choosing the parameters prime and check_cocycle_condition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/parameters_prime_and_check_cocycle_condition.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Choosing-the-parameters-prime-and-check_cocycle_condition">
<h1>Choosing the parameters prime and check_cocycle_condition<a class="headerlink" href="#Choosing-the-parameters-prime-and-check_cocycle_condition" title="Permalink to this heading"></a></h1>
<p>The purpose of this example is to demonstrate the effect of different choices of the prime parameter, and to explain why you should probably leave the default check_cocycle_condition = True.</p>
<p>These parameters only apply to the circular and the toroidal coordinates algorithms.</p>
<section id="The-prime-parameter">
<h2>The prime parameter<a class="headerlink" href="#The-prime-parameter" title="Permalink to this heading"></a></h2>
<p>This parameter tells the algorithm which prime field to use when computing persistent cohomology. Specifically, if prime = p for <span class="math notranslate nohighlight">\(p\)</span> a prime, the algorithm will use cohomology with coefficients in the field <span class="math notranslate nohighlight">\(\mathbb{Z}/p\mathbb{Z}\)</span>.</p>
<p>Field coefficients are required for the persistence algorithm (and to have a well-defined persistence diagram), but, once a cohomology class has been selected using the cocycle_idx parameter, this cohomology class must be lifted to cohomology with <em>integer</em> coefficients - that is <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span> coefficients - because of how the representability theorem of cohomology works. This is where the parameter check_cocycle_condition comes into play.</p>
</section>
<section id="The-check_cocycle_condition-parameter">
<h2>The check_cocycle_condition parameter<a class="headerlink" href="#The-check_cocycle_condition-parameter" title="Permalink to this heading"></a></h2>
<p>The circular coordinates algorithms that appear in current published papers use a heuristic (recalled below) in order to lift cohomology classes from <span class="math notranslate nohighlight">\(\mathbb{Z}/p\mathbb{Z}\)</span> coefficients to <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span> coefficients. This heuristic works well when the topology of the data is not too complicated, but it can fail when the topology of the data is more complex.</p>
<p>The check_cocycle_condition parameter tells the algorithm whether to check that the heuristic mentioned above worked, and, in case it didn’t, to fix the lift in order to have it actually represent an integral cohomology class.</p>
<p>In general, check_cocycle_condition = False will result in less computation time but in a circle-valued map that can fail to be continuous. We recommend leaving check_cocycle_condition = True unless computational time becomes an issue that cannot be overcome by, for instance, reducing the n_landmarks parameter.</p>
<section id="Heuristic-for-lifting-cohomology-classes-and-algorithm-for-fixing-the-lack-cocycle-condition">
<h3>Heuristic for lifting cohomology classes and algorithm for fixing the lack cocycle condition<a class="headerlink" href="#Heuristic-for-lifting-cohomology-classes-and-algorithm-for-fixing-the-lack-cocycle-condition" title="Permalink to this heading"></a></h3>
<p>The heuristic takes a cocycle <span class="math notranslate nohighlight">\(\eta \in Z^1(K ; \mathbb{Z}/p\mathbb{Z})\)</span> and returns the cochain <span class="math notranslate nohighlight">\(\eta' \in C^1(K ; \mathbb{Z})\)</span> with value on an edge <span class="math notranslate nohighlight">\((i,j) \in K\)</span> given by <span class="math notranslate nohighlight">\(\eta(i,j)\)</span> if <span class="math notranslate nohighlight">\(\eta(i,j) &lt; p/2\)</span> and <span class="math notranslate nohighlight">\(p - \eta(i,j)\)</span> otherwise. It can happen, however, that the cochain <span class="math notranslate nohighlight">\(\eta'\)</span> does not satisfy the cocycle condition.</p>
<p>It is explained in (de Silva, Morozov, Vejdemo-Johansson, 2011) that, if the class represented by <span class="math notranslate nohighlight">\(\eta\)</span> does admit an integral lift, then one can find such a lift by “fixing” <span class="math notranslate nohighlight">\(\eta'\)</span> using a linear integer program; we refer the reader to the paper for details. DREiMac uses the function milp from scipy to solve this integer program.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dreimac</span> <span class="kn">import</span> <span class="n">CircularCoords</span><span class="p">,</span> <span class="n">GeometryExamples</span><span class="p">,</span> <span class="n">PlotUtils</span><span class="p">,</span> <span class="n">CircleMapUtils</span>
<span class="kn">from</span> <span class="nn">persim</span> <span class="kn">import</span> <span class="n">plot_diagrams</span>
</pre></div>
</div>
</div>
<p>The data consists of a trefoil knot in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<p>The topological complexity of the data comes from its embedding. As we showed in the notebook about the choice of the parameters n_landmarks and cocycle_idx, this point cloud has a single circular feature that gets represented in different ways depending on the scale (small or large) at which the data is looked at.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">GeometryExamples</span><span class="o">.</span><span class="n">trefoil</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">,</span> <span class="n">horizontal_width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trefoil 2D projection&quot;</span><span class="p">)</span> <span class="p">;</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> <span class="p">;</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trefoil in 3D&quot;</span><span class="p">)</span> <span class="p">;</span>  <span class="n">_</span> <span class="o">=</span> <span class="n">PlotUtils</span><span class="o">.</span><span class="n">set_axes_equal</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parameters_prime_and_check_cocycle_condition_3_0.png" src="../_images/notebooks_parameters_prime_and_check_cocycle_condition_3_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perc_choices</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">prime</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CircularCoords</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">prime</span><span class="o">=</span><span class="n">prime</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">perc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">perc_choices</span><span class="p">):</span>
    <span class="n">circular_coordinate</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">(</span><span class="n">perc</span><span class="o">=</span><span class="n">perc</span><span class="p">,</span><span class="n">cocycle_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">perc_choices</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">CircleMapUtils</span><span class="o">.</span><span class="n">to_sinebow</span><span class="p">(</span><span class="n">circular_coordinate</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;perc = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">check_cocycle_condition=True&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> <span class="p">;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parameters_prime_and_check_cocycle_condition_4_0.png" src="../_images/notebooks_parameters_prime_and_check_cocycle_condition_4_0.png" />
</div>
</div>
<p>This topological complexity causes the following problem at the larger scale, when the heuristic for lifting cohomology classes is used directly. At a small scale, the heuristic works fine.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perc_choices</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CircularCoords</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">prime</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">perc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">perc_choices</span><span class="p">):</span>
    <span class="n">circular_coordinate</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">(</span><span class="n">perc</span><span class="o">=</span><span class="n">perc</span><span class="p">,</span><span class="n">cocycle_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">check_cocycle_condition</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">perc_choices</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">CircleMapUtils</span><span class="o">.</span><span class="n">to_sinebow</span><span class="p">(</span><span class="n">circular_coordinate</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;perc = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">check_cocycle_condition=False&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> <span class="p">;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parameters_prime_and_check_cocycle_condition_6_0.png" src="../_images/notebooks_parameters_prime_and_check_cocycle_condition_6_0.png" />
</div>
</div>
<p>Now that we know that the heuristic does not work at the larger scale, we suspect that, at this larger scale, the output of the algorithm will depend on the prime parameter. Here we display the output of the algorithm for a range of choices. We see that, in general, the larger the prime, the more complicated the cohomological coordinates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prime_choices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">]</span>
<span class="n">perc</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">prime</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prime_choices</span><span class="p">):</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">CircularCoords</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">prime</span><span class="o">=</span><span class="n">prime</span><span class="p">)</span>
    <span class="n">circular_coordinate</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">(</span><span class="n">perc</span><span class="o">=</span><span class="n">perc</span><span class="p">,</span><span class="n">cocycle_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">prime_choices</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">CircleMapUtils</span><span class="o">.</span><span class="n">to_sinebow</span><span class="p">(</span><span class="n">circular_coordinate</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;prime = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prime</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> <span class="p">;</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parameters_prime_and_check_cocycle_condition_8_0.png" src="../_images/notebooks_parameters_prime_and_check_cocycle_condition_8_0.png" />
</div>
</div>
<p>The above behavior is that of DREiMac’s current implementation. The reason why different primes lead to different circle-valued maps is that the integral lift of a cohomology class <span class="math notranslate nohighlight">\(\eta \in H^1(K ;\mathbb{Z}/p\mathbb{Z})\)</span> is only uniquely determined up to the kernel of the morphism <span class="math notranslate nohighlight">\(H^1(K ; \mathbb{Z}) \to H^1(K ; \mathbb{Z}/p\mathbb{Z})\)</span>, which is usually non-trivial. The upshot is that one should be able to design an optimization procedure that finds good integral lift
<span class="math notranslate nohighlight">\(\eta'\)</span> of <span class="math notranslate nohighlight">\(\eta\)</span> by minimizing a notion of Dirichlet energy. Although this hasn’t been fully developed yet, it is actively being researched.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parameter_standard_range.html" class="btn btn-neutral float-left" title="Choosing the parameter standard_range" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coil20.html" class="btn btn-neutral float-right" title="Circular coordinates on COIL-20 data set" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Jose A. Perea, Luis Scoccola, Chris Tralie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>